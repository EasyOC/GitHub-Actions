name: Check Spelling
description: Checks for spelling errors in files.

inputs:
  dictionary_source_prefixes:
    description: JSON map of prefixes for dictionary urls, "cspell" is necessary
    required: false
    type: string
    default: '{"cspell": "https://raw.githubusercontent.com/check-spelling/cspell-dicts/v20220427/dictionaries/","lombiq": "https://raw.githubusercontent.com/Lombiq/GitHub-Actions/issue/OSOE-158/.github/actions/check-spelling/spelling/"}'
  extra_dictionaries:
    description: Space delimited list of URLs (or `prefix:`+path) to additional word lists
    required: false
    type: string
    default:
      cspell:filetypes/filetypes.txt
      cspell:django/django.txt
      cspell:aws/aws.txt
      cspell:html/html.txt
      cspell:css/css.txt
      cspell:csharp/csharp.txt
      cspell:rust/rust.txt
      cspell:npm/npm.txt
      cspell:dotnet/dotnet.txt
      cspell:scala/scala.txt
      lombiq:expect.txt

permissions:
  contents: read
  pull-requests: read
  actions: read
runs-on: ubuntu-latest

runs:
  using: "composite"
  steps:
  - name: copy-files
    shell: pwsh
    run: | 
      cp .github/actions/spelling/patterns.txt .github/actions/spelling/patterns2.txt
      ls .\tools\
    # cp tools/Lombiq.GitHub.Actions/.github/actions/check-spelling/spelling/excludes.txt .github/actions/spelling/excludes.txt
    
  - name: check-spelling
    id: spelling
    uses: check-spelling/check-spelling@v0.0.20
    with:
      dictionary_source_prefixes: ${{ inputs.dictionary_source_prefixes }}
      extra_dictionaries: ${{ inputs.extra_dictionaries }}
      experimental_apply_changes_via_bot: 0
      suppress_push_for_open_pull_request: 1
      checkout: true
      spell_check_this: check-spelling/spell-check-this@v0.0.20
      post_comment: 1
